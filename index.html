<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Bingo Caller (1â€“90)</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  margin: 0;
  padding: 10px;
}

#reset {
  position: absolute;
  top: 10px;
  right: 10px;
  background: #d32f2f;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
}

.container {
  display: flex;
  gap: 15px;
  margin-top: 50px;
}

.left {
  flex: 1;
  text-align: center;
}

h1 {
  margin-bottom: 20px;
}
#current {
  font-size: 140px;         
  font-weight: bold;
  color: #2e7d32;
  background: white;
  border-radius: 16px;
  padding: 40px;
  margin-bottom: 25px;
  line-height: 1;
}


button.main {
  width: 100%;
  padding: 14px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  color: white;
  margin-bottom: 10px;
  cursor: pointer;
}

#start { background: #388e3c; }
#stop  { background: #f57c00; }

.right {
  flex: 1.2;
  background: white;
  padding: 10px;
  border-radius: 10px;
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 6px;
}

.number-box {
  background: #ffffff;
  border: 1px solid #ccc;
  text-align: center;
  padding: 8px 0;
  border-radius: 6px;
  font-size: 14px;
}

.called {
  background: orange;
  color: white;
  font-weight: bold;
}

@media (max-width: 768px) {
  .container {
    flex-direction: column;
  }
  #current {
    font-size: 90px;
  }
}
</style>
</head>

<body>

<button id="reset" onclick="resetGame()">Reset</button>

<div class="container">

  <div class="left">
    <h1>ðŸŽ± Bingo Caller</h1>
    <div id="current">---</div>
    <button class="main" id="start" onclick="startAuto()">Start</button>
    <button class="main" id="stop" onclick="stopAuto()">Stop</button>
  </div>

  <div class="right" id="board"></div>

</div>

<script>
let numbers = JSON.parse(localStorage.getItem("numbers")) || [];
let index = Number(localStorage.getItem("index")) || 0;
let calledNumbers = JSON.parse(localStorage.getItem("calledNumbers")) || [];

let intervalId = null;
let timeoutId = null;

/* Initialize numbers */
if (numbers.length === 0) {
  for (let i = 1; i <= 90; i++) numbers.push(i);
  numbers.sort(() => Math.random() - 0.5);
  saveData();
}

/* Create board */
const board = document.getElementById("board");
for (let i = 1; i <= 90; i++) {
  const div = document.createElement("div");
  div.className = "number-box";
  div.id = "num-" + i;
  div.innerText = i;
  board.appendChild(div);
}

/* Restore UI */
if (calledNumbers.length > 0) {
  document.getElementById("current").innerText =
    calledNumbers[calledNumbers.length - 1];

  calledNumbers.forEach(n => {
    document.getElementById("num-" + n).classList.add("called");
  });
}

/* ðŸ”Š Voice function */
function speakNumber(num) {
  const msg = new SpeechSynthesisUtterance(num);
  msg.rate = 0.85;
  msg.pitch = 1.1;
  msg.volume = 1;
  speechSynthesis.cancel(); // stop previous voice
  speechSynthesis.speak(msg);
}

function saveData() {
  localStorage.setItem("numbers", JSON.stringify(numbers));
  localStorage.setItem("index", index);
  localStorage.setItem("calledNumbers", JSON.stringify(calledNumbers));
}

function callNumber() {
  if (index >= numbers.length) {
    stopAuto();
    alert("ðŸŽ‰ All numbers have been called!");
    return;
  }

  const num = numbers[index++];
  calledNumbers.push(num);

  document.getElementById("current").innerText = num;
  document.getElementById("num-" + num).classList.add("called");

  speakNumber(num); // ðŸ”Š announce

  saveData();
}

function startAuto() {
  if (intervalId || timeoutId) return;

  timeoutId = setTimeout(() => {
    callNumber();
    intervalId = setInterval(callNumber, 3000);
    timeoutId = null;
  }, 3000);
}

function stopAuto() {
  clearTimeout(timeoutId);
  clearInterval(intervalId);
  timeoutId = null;
  intervalId = null;
}

function resetGame() {
  if (confirm("Reset entire game?")) {
    stopAuto();
    localStorage.clear();
    location.reload();
  }
}
</script>

</body>
</html>
